<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Oscar Alberto Quijano Xacur" />

<meta name="date" content="2020-06-19" />

<title>Introduction to the Unifed Distribution</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to the Unifed Distribution</h1>
<h4 class="author">Oscar Alberto Quijano Xacur</h4>
<h4 class="date">2020-06-19</h4>




<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The unifed distribution is the Exponential Dispersion Family (EDF) generated by the uniform distribution <span class="citation">(see Jørgensen 1997 Chapters 2 and 3 to see how an EDF can be generated from a distribution)</span>. It has support on the interval (0,1).</p>
<p>The <a href="https://CRAN.R-project.org/package=unifed">unifed R package</a> focuses on the case where the dispersion parameter is equal to one. This is due to some numerical problems encountered when trying to implement the general case <span class="citation">(see Quijano Xacur 2019 for details)</span>. The package also includes code for using this distribution with <a href="https://mc-stan.org/">stan</a>.</p>
<p>The unifed can be used as the response distribution of a GLM. Note that although the functions in this package implement the case with dispersion 1, it is still possible to have classes with weights different than one in a unifed GLM. This is because for a GLM we only need to minimize the deviance and disregard the rest of the density (which is the part that gives numerical stability).</p>
<p>We start with a section about Exponential Dispersion Families and their properties. Then we introduce the unifed density, it’s cumulant generator, and unit deviance function. This is followed by an example, where we use the package for fitting a frequentist and a Bayesian unifed GLM to a publicly available dataset. We close with a brief comparison between the unifed GLM and the beta regression.</p>
</div>
<div id="exponential-dispersion-families" class="section level1">
<h1>Exponential Dispersion Families</h1>
<p>An Exponential Dispersion Family (EDF) is a set of distributions whose densities are given by</p>
<p><span class="math display">\[\begin{equation}
f(y|\theta,\phi) = a(y,\phi)\exp\left(\frac{1}{\phi} \left\{y\theta
     - \kappa(\theta) \right\}\right),\qquad \theta\in\Theta, \phi\in\Phi.
\end{equation}\]</span></p>
<p><span class="math inline">\(\theta\)</span> and <span class="math inline">\(\Theta\)</span> are called the canonical parameter and canonical space, respectively and <span class="math inline">\(\phi\)</span> is known as the dispersion parameter. The parametrization above is know as the canonical parametrization. For<span class="math inline">\(\theta\in\mbox{int} \left( \Theta\right)\)</span> (here int stands for interior), <span class="math display">\[  \mathbb{E}[Y] = \dot{\kappa}\left(\theta\right)\qquad \mbox{and}\qquad  \mathbb{V}[Y]=\phi\ddot{\kappa}\left(\theta\right),\]</span> where <span class="math inline">\(\dot{\kappa}=\kappa'\)</span> and <span class="math inline">\(\ddot{\kappa}=\dot{\kappa}'\)</span>. This motivates the following definitions.</p>
<p><strong>Definition</strong> Given an exponential dispersion family, the mean domain of the family is defined as <span class="math display">\[    \Omega = \left\{\mu = \dot{\kappa}\left(\theta\right) : \theta \in \textrm{int}\left(\Theta\right) \right\}.\]</span></p>
<p>Another important property is that the support of the distribution only depends on <span class="math inline">\(\phi\)</span> (and not on <span class="math inline">\(\theta\)</span>). For a given family, let <span class="math inline">\(C_\phi\)</span> be the convex support of any member of the family with dispersion parameter <span class="math inline">\(\phi\)</span>. We define the convex support of the family as <span class="math display">\[C_\Phi=\bigcup_{\phi\in\Phi} C_\phi.\]</span></p>
<p><strong>Definition</strong> The unit deviance function of an exponential dispersion family is defined as<span class="math inline">\(d: C_\Phi\times \Omega \rightarrow [0,\infty)\)</span> with <span class="math display">\[    d\left(y,\mu\right) = 2 \left[ \sup_{\theta\in\Theta}\{\theta y - \kappa (\theta)\} -
      y \dot{\kappa}^{-1}(\mu) + \kappa\big(\dot{\kappa}^{-1}(\mu)\big)
 \right].\]</span></p>
<p>The unit deviance function allows to re-parametrize the densities of the family as <span class="math display">\[\begin{equation}
  \label{eq:mean-value-par}
  f(y|\mu,\phi) = c(y,\phi)\exp\left(-\frac{1}{2\phi}d(y,\mu) \right)
\end{equation}\]</span> for some function <span class="math inline">\(c\)</span>. This is known as the mean–value parametrization.</p>
<div id="weights-and-data-aggregation" class="section level2">
<h2>Weights and Data Aggregation</h2>
<p>In many applications it is useful to include a known positive weight to each observation. When this is done, the dispersion parameter is divided by the weight <span class="math inline">\(w\)</span>, and the canonical and mean–value parametrizations become <span class="math display">\[\begin{align*}
f(y|\theta,\phi) &amp;= a(y,\phi/w)\exp\left(\frac{w}{\phi} \left\{y\theta
     - \kappa(\theta) \right\}\right),\\
f(y|\mu,\phi) &amp;= c(y,\phi/w)\exp\left(-\frac{w}{2\phi}d(y,\mu) \right).
\end{align*}\]</span></p>
<p>There is a useful property of reproductive exponential dispersion families that allows for data aggregation. Jørgensen’s notation <span class="citation">(from Jørgensen 1997)</span> is very convenient to express this property: given a fixed exponential family, if <span class="math inline">\(Y\)</span> belongs to that family with mean <span class="math inline">\(\mu\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span> and weight <span class="math inline">\(w\)</span>, we say that it is <span class="math inline">\(ED(\mu,\phi/w)\)</span> distributed. The property is then as follows: if <span class="math inline">\(Y_1,Y_2,\cdots,Y_n\)</span> are independent, and <span class="math inline">\(Y_i \sim ED(\mu,\phi/w_i)\)</span>, then <span class="math display">\[\begin{equation}
  \label{eq:aggregate-equation}
  \bar{Y}=\frac{w_1Y_1+\cdots+w_nY_n}{w_+}\sim ED(\mu,\phi/w_+),\qquad
  w_+=\sum_{i=1}^n w_i.
\end{equation}\]</span></p>
</div>
</div>
<div id="the-unifed-family" class="section level1">
<h1>The Unifed Family</h1>
<p>The unifed can be characterized as the only EDF containing the uniform distribution. In fact, <em>unifed</em> = <em><strong>uni</strong>form</em> + <em><strong>ed</strong>f</em></p>
<p>Due to the numerical instability <span class="citation">(see Quijano Xacur 2019)</span> of the density when the dispersion parameter is different than 1, we focus here in the case where the dispersion parameter is equal to 1. In this case, the density is given by</p>
<p><span class="math display">\[f(x;\theta) = \left\{
  \begin{array}{ll}
    \frac{\theta}{e^\theta - 1} e^{x \theta} &amp; \mbox{if } \theta \neq 0\\
    1 &amp; \mbox{if } \theta = 0
  \end{array}
  \right. \quad \mbox{for } x \in (0,1),\]</span></p>
<p>where <span class="math inline">\(\theta\)</span> is called the canonical parameter. The <code>unifed</code> package provides the functions <code>dunifed</code>, <code>punifed</code>, <code>qunfied</code> and <code>runifed</code> for the density, distribution, quantile and random generation functions respectively. Here are some examples of use of these functions taken from the documentation</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(unifed)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">dunifed</span>( <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.7</span>), <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.4</span>,<span class="fl">0.7</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">punifed</span>(x,<span class="op">-</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7">p &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">qunifed</span>(p,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">runifed</span>(<span class="dv">20</span>,<span class="op">-</span><span class="fl">3.3</span>)</a></code></pre></div>
<p>The mean of this distribution can be any value in (0,1). In the next a section explicit formula for the mean in terms of <span class="math inline">\(\theta\)</span> is given. A with any proper exponential family, there is a one-to-one correspondence between the mean <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\theta\)</span>. The next graphs show the density of the unifed as the mean varies.</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="cumulant-generator" class="section level1">
<h1>Cumulant generator</h1>
<p>The cumulant generator function characterizes and exponential family. For the unifed it is given by</p>
<p><span class="math display">\[\kappa(\theta)=\left\{
    \begin{array}{ll}
      \log\left(\frac{e^\theta-1}{\theta}\right)&amp; \mbox{if }\theta\neq
                                                  0\\
      0 &amp; \mbox{if }\theta=0
    \end{array}
    \right..\]</span></p>
<p>One difficulty in implementing <span class="math inline">\(\kappa\)</span> in a computer function is that <span class="math inline">\(e^\theta\)</span> above takes the value infinity even for relatively small <span class="math inline">\(\theta\)</span>. For instance <code>exp(1000)</code> in R gives <code>Inf</code>.</p>
<p>To avoid this problem the function that implements <span class="math inline">\(\kappa\)</span> in the package, <code>unifed.kappa</code>, uses an approximation for values of <span class="math inline">\(\theta\)</span> that are greater than 50. This function is implemented as follows</p>
<p><span class="math display">\[\kappa_{mod}(\theta)=\left\{
    \begin{array}{ll}
      \kappa(\theta) &amp; \mbox{if }\theta \leq 50\\
       \theta - \log(\theta) &amp; \mbox{if }\theta &gt; 50
    \end{array}
    \right..\]</span></p>
<p>The justification for this approximation is that if <span class="math inline">\(y\)</span> is defined as <span class="math display">\[ y = \log\left(\frac{e^\theta - 1 }{\theta}\right),\]</span></p>
<p>then also,</p>
<p><span class="math display">\[ y = \theta  -  \log( \theta + e^{-y}).\]</span></p>
<p>Now, <span class="math inline">\(\kappa\)</span> is an increasing function and <span class="math inline">\(y\)</span> goes to infinity as <span class="math inline">\(\theta\)</span> goes to infinity. Thus for large values of <span class="math inline">\(\theta\)</span> the term <span class="math inline">\(e^{-y}\)</span> is close to zero. We use 50 as the threshold for the approximation since evaluating the following code in R already gives zero</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"> <span class="kw">log</span>( ( <span class="kw">exp</span>(<span class="dv">50</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">50</span>  ) <span class="op">-</span><span class="st"> </span>( <span class="dv">50</span> <span class="op">-</span><span class="st"> </span><span class="kw">log</span> (<span class="dv">50</span>) )</a></code></pre></div>
</div>
<div id="the-variance-and-unit-deviance-functions" class="section level1">
<h1>The Variance and Unit Deviance Functions</h1>
<p>From the properties of exponential families we know then that if <span class="math inline">\(X\)</span> follows a unifed distribution distribution with canonical parameter <span class="math inline">\(\theta\)</span>, its mean and variance are given by</p>
<p><span class="math display">\[\begin{aligned}
  \mathbb{E}[X]&amp;= \dot{\kappa}(\theta) = \left\{
  \begin{array}{ll}
   \frac{(\theta-1)e^\theta + 1}{\theta(e^\theta -1)} &amp; \mbox{if
                                                        }\theta \neq
                                                        0\\
    \frac{1}{2} &amp; \mbox{if }\theta=0
  \end{array}
  \right., \qquad \\
  \mathbb{V}[X]&amp;= \ddot{\kappa}(\theta)=\left\{
    \begin{array}{ll}
      \left(\frac{ e^{2\theta} - (\theta+2)e^\theta + 1}
      {\theta^2 (e^\theta-1)^2}\right)&amp; \mbox{if }\theta \neq 0 \\
      \frac{1}{12} &amp; \mbox{if }\theta=0.
    \end{array}
    \right.
\end{aligned}\]</span></p>
<p>Where <span class="math inline">\(\dot{\kappa}\)</span> and <span class="math inline">\(\ddot{\kappa}\)</span> are the first and second derivative of <span class="math inline">\(\kappa\)</span>, respectively. The variance function allows us to express the variance in terms of the mean. It is defined as</p>
<p><span class="math display">\[{\bf V}(\mu) = \ddot{\kappa}(\dot{\kappa}^{-1}(\mu)).\]</span></p>
<p>We have not been able to find an analytical expression for <span class="math inline">\(\dot{\kappa}^{-1}(\mu)\)</span>. Thus, the function <code>unifed.kappa.prime.inverse</code>implements it using the <a href="https://en.wikipedia.org/wiki/Newton%27s_method">Newton-Raphson method</a> for solving equations. It takes a value between 0 and 1 and it returns the value of <span class="math inline">\(\theta\)</span> that corresponds to that mean. There are some numerical stability problems around 0 and 0.5.</p>
<p>In order to solve the problem around 0.5, this function returns 0 (which is the image of 0.5), for every <span class="math inline">\(\mu\)</span> with <span class="math inline">\(|\mu - 0.5|&lt;0.0001\)</span>.</p>
<p>To address the problems around 0, <code>unifed.kappa.prime.inverse</code> returns <span class="math inline">\(-\dot{\kappa}^{-1}(1-\mu)\)</span> for <span class="math inline">\(\mu&lt;0.1\)</span>. The justification for this is that for every <span class="math inline">\(\theta\)</span></p>
<p><span class="math display">\[\dot{\kappa}(\theta) = 1 - \dot{\kappa}(-\theta).\]</span></p>
<p>In the package the variance function is implemented by the function <code>unifed.varf</code>. The following code plots of the values of the variance function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">length.out=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">y &lt;-<span class="st"> </span><span class="kw">unifed.varf</span>(x)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">plot</span>(x,y,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">expression</span>(mu),<span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">bold</span>(V)(mu)),<span class="dt">main=</span><span class="st">&quot;Unifed Variance Function&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We do not have an analytical expression for the unit deviance. The package provides the function <code>unifed.deviance</code> that computes the deviance numerically. It uses <code>unifed.kappa.prime.inverse</code> and the fact that the deviance can be expressed as</p>
<p><span class="math display">\[d\left(y,\mu\right) = 2 \left[ y\{ \dot{\kappa}^{-1}(y)
        -\dot{\kappa}^{-1}(\mu) \}  - 
        \kappa\big(\dot{\kappa}^{-1}(y)\big) +
        \kappa\big(\dot{\kappa}^{-1}(\mu)\big)
 \right].\]</span></p>
</div>
<div id="unifed-glm---an-illustrative-example" class="section level1">
<h1>Unifed GLM - An Illustrative Example</h1>
<p>The package provides the function <code>unifed</code> which returns a family that can be used with the <code>glm</code> function of R. This section gives an example of how to prepare a dataset and fit a unifed GLM.</p>
<p>The data from this section appears in <span class="citation">Jong and Heller (2008)</span>. It is based on 67,856 one–year auto in- surance policies from 2004 or 2005. It can be downloaded from the <a href="http://www.acst.mq.edu.au/GLMsforInsuranceData">companion site of the book</a>, as the dataset called Car. The following text is the description of the variables provided by the website of the book</p>
<pre><code>This data set is based on  one-year vehicle insurance
policies taken out in 2004 or 2005. There are 67856 policies, of
which  4624 (6.8%) had at least one claim. 

Variables:

veh_value   vehicle value, in $10,000s
exposure    0-1
clm     occurrence of claim (0 = no, 1 = yes)
numclaims   number of claims
claimcst0   claim amount (0 if no claim)
veh_body    vehicle body, coded as
              BUS
              CONVT = convertible  
              COUPE 
              HBACK = hatchback              
              HDTOP = hardtop
              MCARA = motorized caravan
              MIBUS = minibus
              PANVN = panel van
              RDSTR = roadster
              SEDAN    
              STNWG = station wagon
              TRUCK           
              UTE - utility
veh_age age of vehicle: 1 (youngest), 2, 3, 4
gender      gender of driver: M, F
area        driver's area of residence: A, B, C, D, E, F
agecat      driver's age category: 1 (youngest), 2, 3, 4, 5, 6</code></pre>
<p>We are interested in modeling the exposure; which is the proportion of time in a year in which the insurance policy is in-force for a given client. We use <code>gender</code>, <code>agecat</code>, <code>area</code> and <code>veh_age</code> as the explanatory variables.</p>
<div id="downloading-and-preparing-the-data" class="section level2">
<h2>Downloading and Preparing the Data</h2>
<p>The following line of code downloads a csv file containing the data and stores in the file <code>car.csv</code> in your working folder.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">download.file</span>(<span class="st">&quot;http://www.businessandeconomics.mq.edu.au/__data/assets/file/0011/232310/car.csv&quot;</span>,<span class="dt">destfile=</span><span class="st">&quot;car.csv&quot;</span>)</a></code></pre></div>
<p>The following block reads and aggregates the data using data frames</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">car.data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;car.csv&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">car.data<span class="op">$</span>agecat &lt;-<span class="st"> </span><span class="kw">factor</span>(car.data<span class="op">$</span>agecat)</a>
<a class="sourceLine" id="cb6-3" title="3">car.data<span class="op">$</span>veh_age &lt;-<span class="st"> </span><span class="kw">factor</span>(car.data<span class="op">$</span>veh_age)</a>
<a class="sourceLine" id="cb6-4" title="4"></a>
<a class="sourceLine" id="cb6-5" title="5">agg.car.data &lt;-<span class="st"> </span><span class="kw">aggregate</span>( <span class="kw">cbind</span>(exposure,<span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">dim</span>(car.data)[<span class="dv">1</span>] )) <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>agecat <span class="op">+</span><span class="st"> </span>area <span class="op">+</span><span class="st"> </span>veh_age,</a>
<a class="sourceLine" id="cb6-6" title="6">                          <span class="dt">data=</span>car.data,</a>
<a class="sourceLine" id="cb6-7" title="7">                          <span class="dt">FUN=</span>sum)</a>
<a class="sourceLine" id="cb6-8" title="8"></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw">colnames</span>(agg.car.data)[<span class="kw">colnames</span>(agg.car.data) <span class="op">==</span><span class="st"> &quot;V2&quot;</span>] &lt;-<span class="st"> &quot;weight&quot;</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="kw">colnames</span>(agg.car.data)[<span class="kw">colnames</span>(agg.car.data) <span class="op">==</span><span class="st"> &quot;exposure&quot;</span>] &lt;-<span class="st"> &quot;class.exposure&quot;</span></a>
<a class="sourceLine" id="cb6-11" title="11">agg.car.data<span class="op">$</span>class.exposure &lt;-<span class="st"> </span>agg.car.data<span class="op">$</span>class.exposure <span class="op">/</span><span class="st"> </span>agg.car.data<span class="op">$</span>weight</a></code></pre></div>
<p>Using <code>data.table</code> the same can be achieved with the following</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb7-2" title="2">car.data &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;car.csv&quot;</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">car.data[,agecat<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(agecat)]</a>
<a class="sourceLine" id="cb7-4" title="4">car.data[,veh_age<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(veh_age)]</a>
<a class="sourceLine" id="cb7-5" title="5"></a>
<a class="sourceLine" id="cb7-6" title="6">agg.car.data &lt;-<span class="st"> </span>car.data[,.(<span class="dt">class.exposure=</span><span class="kw">sum</span>(exposure)<span class="op">/</span>.N,</a>
<a class="sourceLine" id="cb7-7" title="7">                            <span class="dt">weight=</span>.N),</a>
<a class="sourceLine" id="cb7-8" title="8">                            by=.(gender,agecat,area,veh_age)]</a></code></pre></div>
</div>
<div id="fitting-and-diagnostics" class="section level2">
<h2>Fitting and Diagnostics</h2>
<p>Now that we have an aggregated version of our data in the variable <code>agg.car.data</code>, we can fit a unifed GLM as follows</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">exposure.model &lt;-<span class="st"> </span><span class="kw">glm</span>(class.exposure <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>agecat <span class="op">+</span><span class="st"> </span>area <span class="op">+</span><span class="st"> </span>veh_age,</a>
<a class="sourceLine" id="cb8-2" title="2">                 <span class="dt">family=</span><span class="kw">unifed</span>(),</a>
<a class="sourceLine" id="cb8-3" title="3">                 <span class="dt">weights=</span>weight,</a>
<a class="sourceLine" id="cb8-4" title="4">                 <span class="dt">data=</span>agg.car.data)</a></code></pre></div>
<p>The default link function for the unifed family is the logistic function. Since no argument as passed to <code>unifed</code> above it is the one being here. The documentation of <code>unifed</code> contains the other functions that can be used as link function and how to select them.</p>
<p>To see the glm summary of this model, we use the <code>summary</code> function. For the unifed family, it is necessary to pass the argument <code>dispersion=1</code> explicitly. Otherwise we would be getting information for a unifed quasi family.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">summary</span>(exposure.model)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = class.exposure ~ gender + agecat + area + veh_age, 
##     family = unifed(), data = agg.car.data, weights = weight)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.7196  -0.6981   0.1040   0.7400   2.5148  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.331898   0.019711 -16.838  &lt; 2e-16 ***
## genderM      0.028770   0.008995   3.198 0.001382 ** 
## agecat2      0.001109   0.018361   0.060 0.951818    
## agecat3      0.053024   0.017834   2.973 0.002947 ** 
## agecat4      0.058287   0.017770   3.280 0.001038 ** 
## agecat5      0.104217   0.018921   5.508 3.63e-08 ***
## agecat6      0.069233   0.020958   3.303 0.000955 ***
## areaB        0.023933   0.013491   1.774 0.076057 .  
## areaC        0.001392   0.012120   0.115 0.908564    
## areaD        0.005330   0.015666   0.340 0.733668    
## areaE        0.011977   0.017545   0.683 0.494834    
## areaF        0.087916   0.021438   4.101 4.11e-05 ***
## veh_age2     0.170794   0.013775  12.398  &lt; 2e-16 ***
## veh_age3     0.161287   0.013262  12.162  &lt; 2e-16 ***
## veh_age4     0.154869   0.013429  11.533  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for unifed family taken to be 1)
## 
##     Null deviance: 585.47  on 287  degrees of freedom
## Residual deviance: 297.86  on 273  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<p>The following shows a plot of the deviance residuals for this model</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">plot</span>(<span class="kw">predict</span>(exposure.model, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>),</a>
<a class="sourceLine" id="cb11-2" title="2">     <span class="kw">residuals</span>(exposure.model, <span class="dt">type=</span><span class="st">&quot;deviance&quot;</span>),</a>
<a class="sourceLine" id="cb11-3" title="3">     <span class="dt">xlab=</span><span class="st">&quot;Predicted value&quot;</span>,</a>
<a class="sourceLine" id="cb11-4" title="4">     <span class="dt">ylab=</span><span class="st">&quot;Deviance residuals&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="verifying-data-aggregation" class="section level2">
<h2>Verifying Data Aggregation</h2>
<p>We mentioned before that GLMs allow for data aggregation. We use the example from the previous section to show explicitly what that means.</p>
<p>Let us fit the glm again but without aggregating the data:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">exposure.model<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(exposure <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>agecat <span class="op">+</span><span class="st"> </span>area <span class="op">+</span><span class="st"> </span>veh_age,</a>
<a class="sourceLine" id="cb12-2" title="2">                        <span class="dt">family=</span><span class="kw">unifed</span>(),</a>
<a class="sourceLine" id="cb12-3" title="3">                        <span class="dt">data=</span>car.data)</a></code></pre></div>
<p>If you see the coefficients of the model above and compare them to the coefficients of the model in the previous section you will see that there are practically the same. Thus, when we said that the unifed GLM is suitable for data aggregation we meant that the fitted coefficients are the same for the original and the aggregated data. Note that this property is not exclusive for the unifed GLM. It is true for every GLM where the response is a continuous distribution.</p>
<p>Now, not all the printed decimals of the coefficients of both models are the same. This is because the algorithm for fitting glms stops after a convergence tolerance condition in the variation of the coefficients between iterations is met. If we want to decrease the variation between both models we can simply make the tolerance condition more strict by using the <code>control</code> argument of the <code>glm</code> function for both models:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">exposure.model &lt;-<span class="st"> </span><span class="kw">glm</span>(class.exposure <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>agecat <span class="op">+</span><span class="st"> </span>area <span class="op">+</span><span class="st"> </span>veh_age,</a>
<a class="sourceLine" id="cb13-2" title="2">                      <span class="dt">family=</span><span class="kw">unifed</span>(),</a>
<a class="sourceLine" id="cb13-3" title="3">                      <span class="dt">weights=</span>weight,</a>
<a class="sourceLine" id="cb13-4" title="4">                      <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">epsilon=</span><span class="fl">1e-20</span>,<span class="dt">maxit=</span><span class="fl">1e5</span>),</a>
<a class="sourceLine" id="cb13-5" title="5">                      <span class="dt">data=</span>agg.car.data)</a>
<a class="sourceLine" id="cb13-6" title="6"></a>
<a class="sourceLine" id="cb13-7" title="7">exposure.model<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(exposure <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>agecat <span class="op">+</span><span class="st"> </span>area <span class="op">+</span><span class="st"> </span>veh_age,</a>
<a class="sourceLine" id="cb13-8" title="8">                        <span class="dt">family=</span><span class="kw">unifed</span>(),</a>
<a class="sourceLine" id="cb13-9" title="9">                        <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">epsilon=</span><span class="fl">1e-20</span>,<span class="dt">maxit=</span><span class="fl">1e5</span>),</a>
<a class="sourceLine" id="cb13-10" title="10">                        <span class="dt">data=</span>car.data)</a></code></pre></div>
</div>
<div id="bayesian-unifed-glm" class="section level2">
<h2>Bayesian Unifed GLM</h2>
<p>The package provides stan code for working with the unifed. It includes functions for computing the density and cumulative distribution function, random number generator, the cumulant generator and two of it’s derivatives. See the section unifed.stan in the manual of the package to see a comprehensive list. If you would like to get familiar with stan you could start with <a href="https://mc-stan.org/rstan/articles/rstan.html">this tutorial</a>.</p>
<p>We show now how to fit a Bayesian version of the unifed GLM example shown above in stan. For this we use the function <code>unifed_glm_lp</code>, which receives three arguments: a vector with the observed responses, the vector of canonical parameters and a vector of weights.</p>
<p>First save the following stan code in a file <code>unifed_example.stan</code>. Note that a normal distribution with mean 0 and standard deviation 20 is used as the prior of the regression coefficients.</p>
<pre><code>functions{
#include unifed.stan
}

data{
  int&lt;lower=1&gt; M; //Rows in the design matrix
  int&lt;lower=1&gt; P; //Columns in the design matrix
  matrix[M,P] X;
  vector&lt;lower=0,upper=1&gt;[M] y;
  int&lt;lower=1&gt; ws[M]; //Number of observations in each class
}


parameters{
  vector[P] beta;
}

transformed parameters{
  vector[M] theta;
  theta = X*beta;   
}


model{ 
  beta ~ normal(0,20);
  unifed_glm_lp(y, theta , to_vector(ws));      
}

generated quantities{
  vector[M] replicated_samples=rep_vector(0,M);
  vector[M] mu;
  
  for(i in 1:M){
    int Nobs;
    Nobs=ws[i];
    for(n in 1:Nobs ){
      replicated_samples[i]+=unifed_rng(theta[i]);
    }
    replicated_samples[i]/=Nobs;
    mu[i]=unifed_kappa_prime(theta[i]);
  }}</code></pre>
<p>The include statement makes reference to the stan file provided in the unifed function. When the code is compiled we have to tell stan where to find that file. The R functions <code>unifed.stan.path</code> and <code>unifed.stan.folder</code> return the full path to the file and to the folder containing it respectively.</p>
<p>We now format data for the stan code. For this we use the variable <code>agg.car.data</code> defined before.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>agecat <span class="op">+</span><span class="st"> </span>area <span class="op">+</span><span class="st"> </span>veh_age, agg.car.data)</a>
<a class="sourceLine" id="cb15-2" title="2"></a>
<a class="sourceLine" id="cb15-3" title="3">model.data &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">M=</span><span class="kw">dim</span>(X)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb15-4" title="4">                   <span class="dt">P=</span><span class="kw">dim</span>(X)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb15-5" title="5">                   <span class="dt">X=</span>X,</a>
<a class="sourceLine" id="cb15-6" title="6">                   <span class="dt">y=</span> agg.car.data<span class="op">$</span>class.exposure,</a>
<a class="sourceLine" id="cb15-7" title="7">                   <span class="dt">ws=</span> agg.car.data<span class="op">$</span>weight)</a></code></pre></div>
<p>Finally, the following code compiles the stan code, gets the simulations and saves them in the variable <code>m1</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">library</span>(rstan)</a>
<a class="sourceLine" id="cb16-2" title="2">model.list &lt;-<span class="st"> </span><span class="kw">stanc_builder</span>(<span class="st">&quot;unifed_example.stan&quot;</span>,</a>
<a class="sourceLine" id="cb16-3" title="3">                            <span class="dt">isystem=</span><span class="kw">unifed.stan.folder</span>())</a>
<a class="sourceLine" id="cb16-4" title="4"></a>
<a class="sourceLine" id="cb16-5" title="5">m1 &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">model_code=</span>model.list<span class="op">$</span>model_code,</a>
<a class="sourceLine" id="cb16-6" title="6">           <span class="dt">data=</span>model.data,</a>
<a class="sourceLine" id="cb16-7" title="7">           <span class="dt">warmup=</span><span class="fl">3e3</span>,</a>
<a class="sourceLine" id="cb16-8" title="8">           <span class="dt">iter=</span><span class="fl">2e4</span>,</a>
<a class="sourceLine" id="cb16-9" title="9">           <span class="dt">chains=</span><span class="dv">4</span>)</a></code></pre></div>
</div>
</div>
<div id="comparison-to-the-beta-regression" class="section level1">
<h1>Comparison to the Beta Regression</h1>
<p>The beta regression <span class="citation">(Ferrari and Cribari-Neto 2004)</span> is a model for applications with a response variable in (0,1). In R it is implemented in the package <code>betareg</code> <span class="citation">(Cribari-Neto and Zeileis 2010)</span>. That package includes the enhancements of the model from <span class="citation">Simas, Barreto-Souza, and Rocha (2010)</span>, where explanatory variables are also used for the dispersion parameter.</p>
<p>The density of the beta distribution is much more flexible than the density of the unifed distribution. To see this compare the plot of the unifed densities shown here with the one provided for the beta in <span class="citation">Ferrari and Cribari-Neto (2004)</span>.</p>
<p>In the cases where both a unifed GLM and a beta regression give a similar fit, the parsimony principle suggests to take the unifed GLM since it has less parameters.</p>
<p>On the computational side, when using an unifed GLM one can apply the properties of reproductive EDFs for data reduction.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<!--  LocalWords:  frequentist
 -->
<div id="refs" class="references">
<div id="ref-r-beta-regression">
<p>Cribari-Neto, Francisco, and Achim Zeileis. 2010. “Beta Regression in R.” <em>Journal of Statistical Software</em> 34 (2): 1–24. <a href="http://www.jstatsoft.org/v34/i02/" class="uri">http://www.jstatsoft.org/v34/i02/</a>.</p>
</div>
<div id="ref-beta-regression">
<p>Ferrari, Silvia, and Francisco Cribari-Neto. 2004. “Beta Regression for Modelling Rates and Proportions.” <em>Journal of Applied Statistics</em> 31 (7): 799–815. <a href="https://doi.org/10.1080/0266476042000214501" class="uri">https://doi.org/10.1080/0266476042000214501</a>.</p>
</div>
<div id="ref-glm-insurance-book">
<p>Jong, P. de, and G.Z. Heller. 2008. <em>Generalized Linear Models for Insurance Data</em>. Cambridge University Press. <a href="http://dx.doi.org/10.1017/CBO9780511755408" class="uri">http://dx.doi.org/10.1017/CBO9780511755408</a>.</p>
</div>
<div id="ref-Jorgensen-book">
<p>Jørgensen, B. 1997. <em>The Theory of Dispersion Models</em>. Chapman &amp; Hall, London.</p>
</div>
<div id="ref-unifed-article">
<p>Quijano Xacur, Oscar Alberto. 2019. “The Unifed Distribution.” <em>Journal of Statistical Distributions and Applications</em> 6 (1): 13. <a href="https://doi.org/10.1186/s40488-019-0102-6" class="uri">https://doi.org/10.1186/s40488-019-0102-6</a>.</p>
</div>
<div id="ref-beta-double-regression">
<p>Simas, Alexandre B., Wagner Barreto-Souza, and Andréa V. Rocha. 2010. “Improved Estimators for a General Class of Beta Regression Models.” <em>Computational Statistics &amp; Data Analysis</em> 54 (2): 348–66. <a href="https://doi.org/10.1016/j.csda.2009.08.017" class="uri">https://doi.org/10.1016/j.csda.2009.08.017</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
